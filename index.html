<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Favicon Generator</title>
  <style>
    body { font-family: sans-serif; background: #f9f9f9; margin: 0; padding: 0; }
    .container { max-width: 400px; margin: 40px auto; background: #fff; border-radius: 8px; box-shadow: 0 2px 8px #0001; padding: 24px; }
    h2 { margin-top: 0; }
    label { display: block; margin: 12px 0 4px; }
    input[type="text"], input[type="color"] { width: 100%; padding: 6px; box-sizing: border-box; }
    input[type="file"] { margin-bottom: 12px; }
    button { margin-top: 16px; padding: 10px 18px; background: #0078d7; color: #fff; border: none; border-radius: 4px; cursor: pointer; }
    button:disabled { background: #aaa; }
    .msg { margin-top: 16px; color: #0078d7; }
    .error { color: #d70022; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Favicon Generator</h2>
    <form id="faviconForm">
      <label>Image (PNG/JPG):</label>
      <input type="file" name="image" accept="image/*" required>
      <label>App Name:</label>
      <input type="text" name="name" placeholder="My App">
      <label>Short Name:</label>
      <input type="text" name="short_name" placeholder="App">
      <label>Theme Color:</label>
      <input type="color" name="theme_color" value="#ffffff">
      <label>Background Color:</label>
      <input type="color" name="background_color" value="#ffffff">
      <label>Tile Color (Windows):</label>
      <input type="color" name="tile_color" value="#ffffff">
      <button type="submit">Generate Favicons ZIP</button>
    </form>
    <div class="msg" id="msg"></div>
  </div>
<script type="module">
  import { Client } from "https://cdn.jsdelivr.net/npm/@gradio/client/dist/index.min.js";
  const form = document.getElementById('faviconForm');
  const msg = document.getElementById('msg');

  form.onsubmit = async e => {
    e.preventDefault();
    msg.textContent = '';
    msg.className = 'msg';

    const imageInput = form.querySelector('input[type="file"]');
    if (!imageInput.files[0]) {
      msg.textContent = 'Please select an image.';
      msg.className = 'msg error';
      return;
    }

    form.querySelector('button').disabled = true;
    msg.textContent = 'Generating...';

    try {
      // Read form values
      const name = form.elements['name'].value || "My App";
      const short_name = form.elements['short_name'].value || "App";
      const theme_color = form.elements['theme_color'].value || "#ffffff";
      const background_color = form.elements['background_color'].value || "#ffffff";
      const tile_color = form.elements['tile_color'].value || "#ffffff";
      const image = imageInput.files[0];

      // Connect to Gradio Space
      const client = await Client.connect("PraneshJs/Favicon-generator");
      const result = await client.predict("/predict", {
        image,
        name,
        short_name,
        theme_color,
        background_color,
        tile_color
      });

      // Download the ZIP
      const url = result.data[0].url || result.data[0].path;
      const a = document.createElement('a');
      a.href = url;
      a.download = 'favicons.zip';
      document.body.appendChild(a);
      a.click();
      a.remove();
      msg.textContent = 'Download started!';
    } catch (err) {
      msg.textContent = 'Error: ' + err.message;
      msg.className = 'msg error';
    }
    form.querySelector('button').disabled = false;
  };
</script>
</body>
</html>